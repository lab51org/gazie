  -----------------------------------------------------------------------
  INTERFACCIA Download ordini e Aggiornamento quantità articoli da Joomla a GAzie
  ------------------------------------------------------------------------
  @Author    Antonio Germani
  @Website   http://www.lacasettabio.it
  @Contact   340-5011912
  @Copyright Copyright (C) 2018 - 2019 Antonio Germani All Rights Reserved.
  versione 1.0
  ------------------------------------------------------------------------ 
  
 Questo è un sistema che interfaccia GAzie ad un sito internet scambiando i dati da un database ad un altro. Proprio per questo meccanismo che non implica
di interagire con il codice del sito, benché sia stato collaudato solo con siti con CMS Joomla, si ritiene debba essere valido anche per altri sistemi.
 Al momento la sincronizzazione è stata testata fra GAzie e alcune applicazioni di Joomla, quali ad esempio Hikashop, Virtuemart, Solidres ma, come già 
detto, per la sua semplicità tecnica è adattabile ad ogni applicazione che utilizzi tabelle di datbase.
 Il tutto si basa su due file di interfaccia, uno presente in GAzie e l'altro presente nella root del sito. Queste doppie interfaccie sono necessarie per 
poter accedere al database del sito internet dal Gestionale di Gazie che spesso è in locale o su un altro host.
  L'interfaccia residente su GAzie può rimanere sempre la stessa mentre quella residente sul sito dovrà essere creata specificatamente in base al tipo di 
componente utilizzato per gestire il negozio online.
 Il meccanismo di funzionamento è semplice; per ovviare al fatto che la maggiorparte dei database non sono gestibili con file residenti all'esterno del 
dominio cui il database appartiene, una prima interfaccia crea un file xml contenente i dati da gestire. Questo file xml viene trasferito nel dominio del 
database da modificare e da lì, con una seconda interfaccia verrà letto e utilizzato per modificare il database. Una sorta di ... cavallo di Troia da noi
autorizzato.

 *ATTIVAZIONE* 
Per attivare questa sincronizzazione, in configurazione utente si deve attivare il modulo "Sincronizza e-commerce". Poi si consiglia di attivare anche il relativo widget in home page.


 *DOWNLOAD ORDINI*

PRIMA DELL'USO, nelle righe iniziali della configurazione avanzata azienda di GAzie, si dovranno inserire i dati di accesso FTP all'host del sito internet,
su Website root directory si dovrà inserire il percorso della cartella su cui si inserira' l'interfaccia (ad esempio: https://www.tuosito.it/syncro/ ). 
 Il file di interfaccia che si inserirà nella suddetta destinazione si dovrà chiamare: ordini-gazie.php. 
  Per evitare intrusioni indesiderate, l'interfaccia di GAzie, al momento di connettersi con quella di Joomla, passa, tramite l'url, una password. Tale 
password è, per comodità, la stessa che GAzie ha per l' FTP e che viene memorizzata su configurazione avanzata azienda. L'interfaccia del sito dovrà, quindi,
fare un controllo sulla password che ha ricevuto da GAzie e, se confermata, si avvierà creando un file xml.
  
  Il file creato dovrà essere formattato come segue:
  
<?xml version="1.0" encoding="ISO-8859-1"?>
<GAzieDocuments AppVersion="2" Creator="Antonio Germani 2018-2019" CreatorUrl="https://www.lacasettabio.it">   
<Documents>	 
	<Document>
	<CustomerCode></CustomerCode>
	<CustomerEmail></CustomerEmail>
	<CustomerName></CustomerName>
	<CustomerSurname></CustomerSurname>
	<CustomerAddress></CustomerAddress>
	<CustomerPostCode></CustomerPostCode>
	<CustomerCity></CustomerCity>
	<CustomerProvince></CustomerProvince>
	<CustomerCountry></CustomerCountry>
	<CustomerFiscalCode></CustomerFiscalCode>
	<CustomerVatCode></CustomerVatCode>
	<CustomerTel></CustomerTel>
	<CustomerCellPhone></CustomerCellPhone>
	<CustomerEmail></CustomerEmail>
	<CustomerPecEmail></CustomerPecEmail>
	<CustomerCodeFattEl></CustomerCodeFattEl>
	<Warehouse></Warehouse>
	<DateOrder></DateOrder>
	<Number></Number>
	<Numbering></Numbering>
	<TotalWithoutTax></TotalWithoutTax>
	<VatAmount></VatAmount>
	<WithholdingTaxAmount>0</WithholdingTaxAmount>
	<Total></Total>
	<PriceList></PriceList>
	<PricesIncludeVat></PricesIncludeVat>
	<WithholdingTaxPerc></WithholdingTaxPerc>
	<PaymentName></PaymentName>
	<PaymentBank></PaymentBank>
	<PaymentBank></PaymentBank>
	<Payments>
 	<Payment>
	<Advance></Advance>
	<Amount></Amount>
	<Paid></Paid>
	</Payment>
	</Payments>
	<Carrier></Carrier>
	<CostShippingDescription></CostShippingDescription>
	<CostShippingAmount></CostShippingAmount>
	<CostPaymentDescription></CostPaymentDescription>
	<CostPaymentAmount></CostPaymentAmount>
	<CostVatCode></CostVatCode>
	<TransportReason></TransportReason>
	<InternalComment></InternalComment>
	<CustomField1></CustomField1>
    <CustomField2></CustomField2>
    <CustomField3></CustomField3>
    <CustomField4></CustomField4>
    <CustomField4></CustomField4>
    <FootNotes></FootNotes>
    <SalesAgent></SalesAgent>
	<Rows>
		<Row>
		<Code></Code>
		<Description></Description>
		<Qty></Qty>
		<MeasureUnit></MeasureUnit>
		<Price></Price>
		<Discounts></Discounts>
		<VatCode></VatCode>
		<Total></Total>
		<Stock></Stock>
		</Row>
	</Rows>
	</Document>
	
Ogni <Document> è la testata dell'ordine mentre le <Row> in esso contenute sono gli articoli ordinati.
	
A causa di eventuali aggiornamenti si consiglia di controllare il codice per vedere se sono stati apportati dei cambiamenti.




*UPLOAD QUANTITà ARTICOLI*

  Per evitare intrusioni indesiderate, l'interfaccia di GAzie, al momento di connettersi con quella di Joomla, passa, tramite l'url,
una password. Tale password è, per comodità, la stessa che GAzie ha per l' FTP e che viene memorizzata su configurazione avanzata azienda.
  
  L'interfaccia di Joomla dovrà, quindi, fare un controllo sulla password che ha ricevuto da GAzie e, se confermata, aggiornerà il database del negozio online.
PRIMA DELL'USO, se ancora non è stato fatto, nelle righe iniziali della configurazione avanzata azienda di GAzie, si dovranno inserire i dati di accesso FTP all'host del sito Joomla e il percorso da seguire per trovare i file di interfaccia. Il file per l'upload residente su joomla si dovrà chiamare articoli-gazie.php

Al contrario dell'download ordini, nell'upload articoli sarà l'interfaccia presente su GAzie a creare il file xml. Questo file sarà poi trasferito via FTP sul sito joomla dove, attraverso la seconda interfaccia ivi residente, i dati saranno processati e verrà aggiornato il database del negozio online.

La formattazione del file xml è la seguente:

<?xml version="1.0" encoding="ISO-8859-1"?>
<GAzieDocuments AppVersion="1" Creator="Antonio Germani 2018-2019" CreatorUrl="https://www.lacasettabio.it">
<Products>
	<Product>
	<Code></Code>
	<BarCode></BarCode>
	<AvailableQty></AvailableQty>
	</Product>
</Products>
</GAzieDocuments>

L'aggiornamento delle quantità avverrà solo se verrà trovata corrispondenza con il codice e/o barcode dell'articolo. Articoli con codici non corrispondenti verranno ignorati.
Altresì, verranno ignorati gli articoli "servizio" di GAzie e quelli dove non sarà stato abilitato il campo "pubblica su sito web".
 A causa di eventuali aggiornamenti si consiglia di controllare il codice per vedere se sono stati apportati dei cambiamenti.



* FILE DI INTERFACCIA DA INSERIRE NEL SITO *
 I file di interfaccia da inserire nel sito devono essere creati in base alle esigenze e alle impostazioni dell'applicazione installata nel sito.
 Nella cartella di GAzie shop_synchronize > interfacce per Joomla ci sono degli esempi da cui partire.
 Se non si ha dimestichezza nell'adattare i file si prega di richiedere assistenza privata specifica.
